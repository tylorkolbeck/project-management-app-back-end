# Migration `20200903035153-just-do-project-owner`

This migration has been generated by tylor.kolbeck@gmail.com at 9/2/2020, 8:51:53 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `todo_db`.`_assigned_projects` DROP FOREIGN KEY `_assigned_projects_ibfk_1`

ALTER TABLE `todo_db`.`_assigned_projects` DROP FOREIGN KEY `_assigned_projects_ibfk_2`

ALTER TABLE `todo_db`.`Project` DROP FOREIGN KEY `project_ibfk_2`

ALTER TABLE `todo_db`.`Project` DROP COLUMN `assigneeId`,
MODIFY `ownerId` int NOT NULL

CREATE UNIQUE INDEX `Project.ownerId_name_unique` ON `todo_db`.`Project`(`ownerId`, `name`)

DROP TABLE `todo_db`.`_assigned_projects`
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200903031453-edit..20200903035153-just-do-project-owner
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -17,29 +17,27 @@
   votes       Vote[]
 }
 model User {
-  id                Int       @id @default(autoincrement())
-  createdAt         DateTime  @default(now())
-  name              String
-  email             String    @unique
-  password          String
-  links             Link[]
-  votes             Vote[]
-  assigned_projects Project[] @relation("assigned_projects")
-  projects          Project[] @relation("owned_projects")
+  id        Int       @id @default(autoincrement())
+  createdAt DateTime  @default(now())
+  name      String
+  email     String    @unique
+  password  String
+  links     Link[]
+  votes     Vote[]
+  projects  Project[]
 }
 model Project {
   id          Int      @id @default(autoincrement())
   createdAt   DateTime @default(now())
   name        String
   description String
-  // OWNER NEEDS TO BE REQUIRED
-  owner       User?    @relation(name: "owned_projects", fields: [ownerId], references: [id])
-  ownerId     Int?
-  assignees   User[]   @relation("assigned_projects", fields: [assigneeId], references: [id])
-  assigneeId  Int?
+  owner       User     @relation(fields: [ownerId], references: [id])
+  ownerId     Int
+
+  @@unique([ownerId, name])
 }
 model Vote {
   id     Int  @id @default(autoincrement())
```


